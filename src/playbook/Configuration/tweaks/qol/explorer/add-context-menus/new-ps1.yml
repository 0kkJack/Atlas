---
title: Add PowerShell Script to 'New' Context Menu
description: Adds PowerShell script (.ps1) to 'New' context menu
privilege: TrustedInstaller
actions:
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\ps1_auto_file'
    value: 'FriendlyTypeName'
    data: 'PowerShell Script'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\.ps1'
    value: '(Default)'
    data: 'ps1_auto_file'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\.ps1\ShellNew'
    value: 'ItemName'
    data: 'New file'
    type: REG_EXPAND_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\.ps1\ShellNew'
    value: 'NullFile'
    data: ''
    type: REG_SZ


